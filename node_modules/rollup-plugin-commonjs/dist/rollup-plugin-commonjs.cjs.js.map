{"version":3,"file":"rollup-plugin-commonjs.cjs.js","sources":["../src/helpers.js","../src/is-cjs.js","../src/default-resolver.js","../src/utils.js","../src/resolve-id.js","../src/ast-utils.js","../src/transform.js","../src/index.js"],"sourcesContent":["export const PROXY_PREFIX = '\\0commonjs-proxy:';\nexport const EXTERNAL_PREFIX = '\\0commonjs-external:';\nexport const HELPERS_ID = '\\0commonjsHelpers';\n\nexport const HELPERS = `\nexport var commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nexport function commonjsRequire () {\n\tthrow new Error('Dynamic requires are not currently supported by rollup-plugin-commonjs');\n}\n\nexport function unwrapExports (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x.default : x;\n}\n\nexport function createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nexport function getCjsExportFromNamespace (n) {\n\treturn n && n.default || n;\n}`;\n","const isCjsPromises = Object.create(null);\n\nexport function getIsCjsPromise(id) {\n\tlet isCjsPromise = isCjsPromises[id];\n\tif (isCjsPromise) return isCjsPromise.promise;\n\n\tconst promise = new Promise(resolve => {\n\t\tisCjsPromises[id] = isCjsPromise = {\n\t\t\tresolve,\n\t\t\tpromise: undefined\n\t\t};\n\t});\n\tisCjsPromise.promise = promise;\n\n\treturn promise;\n}\n\nexport function setIsCjsPromise(id, promise) {\n\tconst isCjsPromise = isCjsPromises[id];\n\tif (isCjsPromise) {\n\t\tif (isCjsPromise.resolve) {\n\t\t\tisCjsPromise.resolve(promise);\n\t\t\tisCjsPromise.resolve = undefined;\n\t\t}\n\t} else {\n\t\tisCjsPromises[id] = { promise, resolve: undefined };\n\t}\n}\n","import * as fs from 'fs';\nimport {dirname, resolve} from 'path';\n\nfunction isFile(file) {\n\ttry {\n\t\tconst stats = fs.statSync(file);\n\t\treturn stats.isFile();\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n\nfunction addJsExtensionIfNecessary(file) {\n\tif (isFile(file)) return file;\n\n\tfile += '.js';\n\tif (isFile(file)) return file;\n\n\treturn null;\n}\n\nconst absolutePath = /^(?:\\/|(?:[A-Za-z]:)?[\\\\|/])/;\n\nfunction isAbsolute(path) {\n\treturn absolutePath.test(path);\n}\n\nexport default function defaultResolver(importee, importer) {\n\t// absolute paths are left untouched\n\tif (isAbsolute(importee)) return addJsExtensionIfNecessary(resolve(importee));\n\n\t// if this is the entry point, resolve against cwd\n\tif (importer === undefined) return addJsExtensionIfNecessary(resolve(process.cwd(), importee));\n\n\t// external modules are skipped at this stage\n\tif (importee[0] !== '.') return null;\n\n\treturn addJsExtensionIfNecessary(resolve(dirname(importer), importee));\n}\n","import {basename, dirname, extname, sep} from 'path';\nimport {makeLegalIdentifier} from 'rollup-pluginutils';\n\nexport function getName(id) {\n\tconst name = makeLegalIdentifier(basename(id, extname(id)));\n\tif (name !== 'index') {\n\t\treturn name;\n\t} else {\n\t\tconst segments = dirname(id).split(sep);\n\t\treturn makeLegalIdentifier(segments[segments.length - 1]);\n\t}\n}\n\n// Return the first non-falsy result from an array of\n// maybe-sync, maybe-promise-returning functions\nexport function first(candidates) {\n\treturn function(...args) {\n\t\treturn candidates.reduce((promise, candidate) => {\n\t\t\treturn promise.then(\n\t\t\t\tresult => (result != null ? result : Promise.resolve(candidate(...args)))\n\t\t\t);\n\t\t}, Promise.resolve());\n\t};\n}\n","import {statSync} from 'fs';\nimport {dirname, resolve, sep} from 'path';\nimport defaultResolver from './default-resolver';\nimport {EXTERNAL_PREFIX, PROXY_PREFIX} from './helpers';\nimport {first} from './utils';\n\nfunction getCandidatesForExtension(resolved, extension) {\n\treturn [resolved + extension, resolved + `${sep}index${extension}`];\n}\n\nfunction getCandidates(resolved, extensions) {\n\treturn extensions.reduce(\n\t\t(paths, extension) => paths.concat(getCandidatesForExtension(resolved, extension)),\n\t\t[resolved]\n\t);\n}\n\nexport function getResolveId(extensions) {\n\tlet resolveUsingOtherResolvers;\n\n\tfunction resolveId(importee, importer) {\n\t\tconst isProxyModule = importee.startsWith(PROXY_PREFIX);\n\t\tif (isProxyModule) {\n\t\t\timportee = importee.slice(PROXY_PREFIX.length);\n\t\t} else if (importee.startsWith('\\0')) {\n\t\t\treturn importee;\n\t\t}\n\n\t\tif (importer && importer.startsWith(PROXY_PREFIX)) {\n\t\t\timporter = importer.slice(PROXY_PREFIX.length);\n\t\t}\n\n\t\treturn resolveUsingOtherResolvers(importee, importer).then(resolved => {\n\t\t\tif (resolved) return isProxyModule ? PROXY_PREFIX + resolved : resolved;\n\n\t\t\tresolved = defaultResolver(importee, importer);\n\n\t\t\tif (isProxyModule) {\n\t\t\t\tif (resolved) return PROXY_PREFIX + resolved;\n\t\t\t\treturn EXTERNAL_PREFIX + importee; // external\n\t\t\t}\n\n\t\t\treturn resolved;\n\t\t});\n\t}\n\n\tresolveId.setRollupOptions = function(options) {\n\t\tconst resolvers = (options.plugins || [])\n\t\t\t.map(plugin => {\n\t\t\t\tif (plugin.resolveId === resolveId) {\n\t\t\t\t\t// substitute CommonJS resolution logic\n\t\t\t\t\treturn (importee, importer) => {\n\t\t\t\t\t\tif (importee[0] !== '.' || !importer) return; // not our problem\n\n\t\t\t\t\t\tconst resolved = resolve(dirname(importer), importee);\n\t\t\t\t\t\tconst candidates = getCandidates(resolved, extensions);\n\n\t\t\t\t\t\tfor (let i = 0; i < candidates.length; i += 1) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tconst stats = statSync(candidates[i]);\n\t\t\t\t\t\t\t\tif (stats.isFile()) return candidates[i];\n\t\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\t\t/* noop */\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn plugin.resolveId;\n\t\t\t})\n\t\t\t.filter(Boolean);\n\n\t\tconst isExternal = id =>\n\t\t\toptions.external\n\t\t\t\t? Array.isArray(options.external)\n\t\t\t\t\t? options.external.includes(id)\n\t\t\t\t\t: options.external(id)\n\t\t\t\t: false;\n\n\t\tresolvers.unshift(id => (isExternal(id) ? false : null));\n\n\t\tresolveUsingOtherResolvers = first(resolvers);\n\t};\n\n\treturn resolveId;\n}\n","export function isReference(node, parent) {\n\tif (parent.type === 'MemberExpression') return parent.computed || node === parent.object;\n\n\t// disregard the `bar` in { bar: foo }\n\tif (parent.type === 'Property' && node !== parent.value) return false;\n\n\t// disregard the `bar` in `class Foo { bar () {...} }`\n\tif (parent.type === 'MethodDefinition') return false;\n\n\t// disregard the `bar` in `export { foo as bar }`\n\tif (parent.type === 'ExportSpecifier' && node !== parent.local) return false;\n\n\treturn true;\n}\n\nexport function flatten(node) {\n\tconst parts = [];\n\n\twhile (node.type === 'MemberExpression') {\n\t\tif (node.computed) return null;\n\n\t\tparts.unshift(node.property.name);\n\t\tnode = node.object;\n\t}\n\n\tif (node.type !== 'Identifier') return null;\n\n\tconst name = node.name;\n\tparts.unshift(name);\n\n\treturn { name, keypath: parts.join('.') };\n}\n\nexport function extractNames(node) {\n\tconst names = [];\n\textractors[node.type](names, node);\n\treturn names;\n}\n\nconst extractors = {\n\tIdentifier(names, node) {\n\t\tnames.push(node.name);\n\t},\n\n\tObjectPattern(names, node) {\n\t\tnode.properties.forEach(prop => {\n\t\t\textractors[prop.value.type](names, prop.value);\n\t\t});\n\t},\n\n\tArrayPattern(names, node) {\n\t\tnode.elements.forEach(element => {\n\t\t\tif (element) extractors[element.type](names, element);\n\t\t});\n\t},\n\n\tRestElement(names, node) {\n\t\textractors[node.argument.type](names, node.argument);\n\t},\n\n\tAssignmentPattern(names, node) {\n\t\textractors[node.left.type](names, node.left);\n\t}\n};\n\nexport function isTruthy(node) {\n\tif (node.type === 'Literal') return !!node.value;\n\tif (node.type === 'ParenthesizedExpression') return isTruthy(node.expression);\n\tif (node.operator in operators) return operators[node.operator](node);\n}\n\nexport function isFalsy(node) {\n\treturn not(isTruthy(node));\n}\n\nfunction not(value) {\n\treturn value === undefined ? value : !value;\n}\n\nfunction equals(a, b, strict) {\n\tif (a.type !== b.type) return undefined;\n\tif (a.type === 'Literal') return strict ? a.value === b.value : a.value == b.value;\n}\n\nconst operators = {\n\t'==': x => {\n\t\treturn equals(x.left, x.right, false);\n\t},\n\n\t'!=': x => not(operators['=='](x)),\n\n\t'===': x => {\n\t\treturn equals(x.left, x.right, true);\n\t},\n\n\t'!==': x => not(operators['==='](x)),\n\n\t'!': x => isFalsy(x.argument),\n\n\t'&&': x => isTruthy(x.left) && isTruthy(x.right),\n\n\t'||': x => isTruthy(x.left) || isTruthy(x.right)\n};\n","import { walk } from 'estree-walker';\nimport MagicString from 'magic-string';\nimport { attachScopes, makeLegalIdentifier } from 'rollup-pluginutils';\nimport { extractNames, flatten, isFalsy, isReference, isTruthy } from './ast-utils.js';\nimport { HELPERS_ID, PROXY_PREFIX } from './helpers.js';\nimport { getName } from './utils.js';\n\nconst reserved = 'process location abstract arguments boolean break byte case catch char class const continue debugger default delete do double else enum eval export extends false final finally float for from function goto if implements import in instanceof int interface let long native new null package private protected public return short static super switch synchronized this throw throws transient true try typeof var void volatile while with yield'.split(\n\t' '\n);\nconst blacklist = { __esModule: true };\nreserved.forEach(word => (blacklist[word] = true));\n\nconst exportsPattern = /^(?:module\\.)?exports(?:\\.([a-zA-Z_$][a-zA-Z_$0-9]*))?$/;\n\nconst firstpassGlobal = /\\b(?:require|module|exports|global)\\b/;\nconst firstpassNoGlobal = /\\b(?:require|module|exports)\\b/;\nconst importExportDeclaration = /^(?:Import|Export(?:Named|Default))Declaration/;\nconst functionType = /^(?:FunctionDeclaration|FunctionExpression|ArrowFunctionExpression)$/;\n\nfunction deconflict(scope, globals, identifier) {\n\tlet i = 1;\n\tlet deconflicted = identifier;\n\n\twhile (scope.contains(deconflicted) || globals.has(deconflicted) || deconflicted in blacklist)\n\t\tdeconflicted = `${identifier}_${i++}`;\n\tscope.declarations[deconflicted] = true;\n\n\treturn deconflicted;\n}\n\nfunction tryParse(parse, code, id) {\n\ttry {\n\t\treturn parse(code, { allowReturnOutsideFunction: true });\n\t} catch (err) {\n\t\terr.message += ` in ${id}`;\n\t\tthrow err;\n\t}\n}\n\nexport function hasCjsKeywords(code, ignoreGlobal) {\n\tconst firstpass = ignoreGlobal ? firstpassNoGlobal : firstpassGlobal;\n\treturn firstpass.test(code);\n}\n\nexport function checkEsModule(parse, code, id) {\n\tconst ast = tryParse(parse, code, id);\n\n\tlet isEsModule = false;\n\tfor (const node of ast.body) {\n\t\tif (node.type === 'ExportDefaultDeclaration')\n\t\t\treturn { isEsModule: true, hasDefaultExport: true, ast };\n\t\tif (node.type === 'ExportNamedDeclaration') {\n\t\t\tisEsModule = true;\n\t\t\tfor (const specifier of node.specifiers) {\n\t\t\t\tif (specifier.exported.name === 'default') {\n\t\t\t\t\treturn { isEsModule: true, hasDefaultExport: true, ast };\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (importExportDeclaration.test(node.type)) isEsModule = true;\n\t}\n\n\treturn { isEsModule, hasDefaultExport: false, ast };\n}\n\nexport function transformCommonjs(\n\tparse,\n\tcode,\n\tid,\n\tisEntry,\n\tignoreGlobal,\n\tignoreRequire,\n\tcustomNamedExports,\n\tsourceMap,\n\tallowDynamicRequire,\n\tastCache\n) {\n\tconst ast = astCache || tryParse(parse, code, id);\n\n\tconst magicString = new MagicString(code);\n\n\tconst required = {};\n\t// Because objects have no guaranteed ordering, yet we need it,\n\t// we need to keep track of the order in a array\n\tconst sources = [];\n\n\tlet uid = 0;\n\n\tlet scope = attachScopes(ast, 'scope');\n\tconst uses = { module: false, exports: false, global: false, require: false };\n\n\tlet lexicalDepth = 0;\n\tlet programDepth = 0;\n\n\tconst globals = new Set();\n\n\tconst HELPERS_NAME = deconflict(scope, globals, 'commonjsHelpers'); // TODO technically wrong since globals isn't populated yet, but ¯\\_(ツ)_/¯\n\n\tconst namedExports = {};\n\n\t// TODO handle transpiled modules\n\tlet shouldWrap = /__esModule/.test(code);\n\n\tfunction isRequireStatement(node) {\n\t\tif (!node) return;\n\t\tif (node.type !== 'CallExpression') return;\n\t\tif (node.callee.name !== 'require' || scope.contains('require')) return;\n\t\tif (node.arguments.length === 0) return; // Weird case of require() without arguments\n\t\treturn true;\n\t}\n\n\tfunction hasDynamicArguments(node) {\n\t\treturn (\n\t\t\tnode.arguments.length > 1 ||\n\t\t\t(node.arguments[0].type !== 'Literal' &&\n\t\t\t\t(node.arguments[0].type !== 'TemplateLiteral' || node.arguments[0].expressions.length > 0))\n\t\t);\n\t}\n\n\tfunction isStaticRequireStatement(node) {\n\t\tif (!isRequireStatement(node)) return;\n\t\tif (hasDynamicArguments(node)) return;\n\t\tif (ignoreRequire(node.arguments[0].value)) return;\n\t\treturn true;\n\t}\n\n\tfunction getRequireStringArg(node) {\n\t\treturn node.arguments[0].type === 'Literal'\n\t\t\t? node.arguments[0].value\n\t\t\t: node.arguments[0].quasis[0].value.cooked;\n\t}\n\n\tfunction getRequired(node, name) {\n\t\tconst sourceId = getRequireStringArg(node);\n\t\tconst existing = required[sourceId];\n\t\tif (existing === undefined) {\n\t\t\tif (!name) {\n\t\t\t\tdo name = `require$$${uid++}`;\n\t\t\t\twhile (scope.contains(name));\n\t\t\t}\n\n\t\t\tsources.push(sourceId);\n\t\t\trequired[sourceId] = { source: sourceId, name, importsDefault: false };\n\t\t}\n\n\t\treturn required[sourceId];\n\t}\n\n\t// do a first pass, see which names are assigned to. This is necessary to prevent\n\t// illegally replacing `var foo = require('foo')` with `import foo from 'foo'`,\n\t// where `foo` is later reassigned. (This happens in the wild. CommonJS, sigh)\n\tconst assignedTo = new Set();\n\twalk(ast, {\n\t\tenter(node) {\n\t\t\tif (node.type !== 'AssignmentExpression') return;\n\t\t\tif (node.left.type === 'MemberExpression') return;\n\n\t\t\textractNames(node.left).forEach(name => {\n\t\t\t\tassignedTo.add(name);\n\t\t\t});\n\t\t}\n\t});\n\n\twalk(ast, {\n\t\tenter(node, parent) {\n\t\t\tif (sourceMap) {\n\t\t\t\tmagicString.addSourcemapLocation(node.start);\n\t\t\t\tmagicString.addSourcemapLocation(node.end);\n\t\t\t}\n\n\t\t\t// skip dead branches\n\t\t\tif (parent && (parent.type === 'IfStatement' || parent.type === 'ConditionalExpression')) {\n\t\t\t\tif (node === parent.consequent && isFalsy(parent.test)) return this.skip();\n\t\t\t\tif (node === parent.alternate && isTruthy(parent.test)) return this.skip();\n\t\t\t}\n\n\t\t\tif (node._skip) return this.skip();\n\n\t\t\tprogramDepth += 1;\n\n\t\t\tif (node.scope) scope = node.scope;\n\t\t\tif (functionType.test(node.type)) lexicalDepth += 1;\n\n\t\t\t// if toplevel return, we need to wrap it\n\t\t\tif (node.type === 'ReturnStatement' && lexicalDepth === 0) {\n\t\t\t\tshouldWrap = true;\n\t\t\t}\n\n\t\t\t// rewrite `this` as `commonjsHelpers.commonjsGlobal`\n\t\t\tif (node.type === 'ThisExpression' && lexicalDepth === 0) {\n\t\t\t\tuses.global = true;\n\t\t\t\tif (!ignoreGlobal)\n\t\t\t\t\tmagicString.overwrite(node.start, node.end, `${HELPERS_NAME}.commonjsGlobal`, {\n\t\t\t\t\t\tstoreName: true\n\t\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// rewrite `typeof module`, `typeof module.exports` and `typeof exports` (https://github.com/rollup/rollup-plugin-commonjs/issues/151)\n\t\t\tif (node.type === 'UnaryExpression' && node.operator === 'typeof') {\n\t\t\t\tconst flattened = flatten(node.argument);\n\t\t\t\tif (!flattened) return;\n\n\t\t\t\tif (scope.contains(flattened.name)) return;\n\n\t\t\t\tif (\n\t\t\t\t\tflattened.keypath === 'module.exports' ||\n\t\t\t\t\tflattened.keypath === 'module' ||\n\t\t\t\t\tflattened.keypath === 'exports'\n\t\t\t\t) {\n\t\t\t\t\tmagicString.overwrite(node.start, node.end, `'object'`, { storeName: false });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// rewrite `require` (if not already handled) `global` and `define`, and handle free references to\n\t\t\t// `module` and `exports` as these mean we need to wrap the module in commonjsHelpers.createCommonjsModule\n\t\t\tif (node.type === 'Identifier') {\n\t\t\t\tif (isReference(node, parent) && !scope.contains(node.name)) {\n\t\t\t\t\tif (node.name in uses) {\n\t\t\t\t\t\tif (node.name === 'require') {\n\t\t\t\t\t\t\tif (allowDynamicRequire) return;\n\t\t\t\t\t\t\tmagicString.overwrite(node.start, node.end, `${HELPERS_NAME}.commonjsRequire`, {\n\t\t\t\t\t\t\t\tstoreName: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tuses[node.name] = true;\n\t\t\t\t\t\tif (node.name === 'global' && !ignoreGlobal) {\n\t\t\t\t\t\t\tmagicString.overwrite(node.start, node.end, `${HELPERS_NAME}.commonjsGlobal`, {\n\t\t\t\t\t\t\t\tstoreName: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// if module or exports are used outside the context of an assignment\n\t\t\t\t\t\t// expression, we need to wrap the module\n\t\t\t\t\t\tif (node.name === 'module' || node.name === 'exports') {\n\t\t\t\t\t\t\tshouldWrap = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (node.name === 'define') {\n\t\t\t\t\t\tmagicString.overwrite(node.start, node.end, 'undefined', { storeName: true });\n\t\t\t\t\t}\n\n\t\t\t\t\tglobals.add(node.name);\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Is this an assignment to exports or module.exports?\n\t\t\tif (node.type === 'AssignmentExpression') {\n\t\t\t\tif (node.left.type !== 'MemberExpression') return;\n\n\t\t\t\tconst flattened = flatten(node.left);\n\t\t\t\tif (!flattened) return;\n\n\t\t\t\tif (scope.contains(flattened.name)) return;\n\n\t\t\t\tconst match = exportsPattern.exec(flattened.keypath);\n\t\t\t\tif (!match || flattened.keypath === 'exports') return;\n\n\t\t\t\tuses[flattened.name] = true;\n\n\t\t\t\t// we're dealing with `module.exports = ...` or `[module.]exports.foo = ...` –\n\t\t\t\t// if this isn't top-level, we'll need to wrap the module\n\t\t\t\tif (programDepth > 3) shouldWrap = true;\n\n\t\t\t\tnode.left._skip = true;\n\n\t\t\t\tif (flattened.keypath === 'module.exports' && node.right.type === 'ObjectExpression') {\n\t\t\t\t\treturn node.right.properties.forEach(prop => {\n\t\t\t\t\t\tif (prop.computed || prop.key.type !== 'Identifier') return;\n\t\t\t\t\t\tconst name = prop.key.name;\n\t\t\t\t\t\tif (name === makeLegalIdentifier(name)) namedExports[name] = true;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (match[1]) namedExports[match[1]] = true;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// if this is `var x = require('x')`, we can do `import x from 'x'`\n\t\t\tif (\n\t\t\t\tnode.type === 'VariableDeclarator' &&\n\t\t\t\tnode.id.type === 'Identifier' &&\n\t\t\t\tisStaticRequireStatement(node.init)\n\t\t\t) {\n\t\t\t\t// for now, only do this for top-level requires. maybe fix this in future\n\t\t\t\tif (scope.parent) return;\n\n\t\t\t\t// edge case — CJS allows you to assign to imports. ES doesn't\n\t\t\t\tif (assignedTo.has(node.id.name)) return;\n\n\t\t\t\tconst required = getRequired(node.init, node.id.name);\n\t\t\t\trequired.importsDefault = true;\n\n\t\t\t\tif (required.name === node.id.name) {\n\t\t\t\t\tnode._shouldRemove = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!isStaticRequireStatement(node)) return;\n\n\t\t\tconst required = getRequired(node);\n\n\t\t\tif (parent.type === 'ExpressionStatement') {\n\t\t\t\t// is a bare import, e.g. `require('foo');`\n\t\t\t\tmagicString.remove(parent.start, parent.end);\n\t\t\t} else {\n\t\t\t\trequired.importsDefault = true;\n\t\t\t\tmagicString.overwrite(node.start, node.end, required.name);\n\t\t\t}\n\n\t\t\tnode.callee._skip = true;\n\t\t},\n\n\t\tleave(node) {\n\t\t\tprogramDepth -= 1;\n\t\t\tif (node.scope) scope = scope.parent;\n\t\t\tif (functionType.test(node.type)) lexicalDepth -= 1;\n\n\t\t\tif (node.type === 'VariableDeclaration') {\n\t\t\t\tlet keepDeclaration = false;\n\t\t\t\tlet c = node.declarations[0].start;\n\n\t\t\t\tfor (let i = 0; i < node.declarations.length; i += 1) {\n\t\t\t\t\tconst declarator = node.declarations[i];\n\n\t\t\t\t\tif (declarator._shouldRemove) {\n\t\t\t\t\t\tmagicString.remove(c, declarator.end);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!keepDeclaration) {\n\t\t\t\t\t\t\tmagicString.remove(c, declarator.start);\n\t\t\t\t\t\t\tkeepDeclaration = true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tc = declarator.end;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!keepDeclaration) {\n\t\t\t\t\tmagicString.remove(node.start, node.end);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\tif (\n\t\t!sources.length &&\n\t\t!uses.module &&\n\t\t!uses.exports &&\n\t\t!uses.require &&\n\t\t(ignoreGlobal || !uses.global)\n\t) {\n\t\tif (Object.keys(namedExports).length) {\n\t\t\tthrow new Error(\n\t\t\t\t`Custom named exports were specified for ${id} but it does not appear to be a CommonJS module`\n\t\t\t);\n\t\t}\n\t\treturn null; // not a CommonJS module\n\t}\n\n\tconst includeHelpers = shouldWrap || uses.global || uses.require;\n\tconst importBlock =\n\t\t(includeHelpers ? [`import * as ${HELPERS_NAME} from '${HELPERS_ID}';`] : [])\n\t\t\t.concat(\n\t\t\t\tsources.map(source => {\n\t\t\t\t\t// import the actual module before the proxy, so that we know\n\t\t\t\t\t// what kind of proxy to build\n\t\t\t\t\treturn `import '${source}';`;\n\t\t\t\t}),\n\t\t\t\tsources.map(source => {\n\t\t\t\t\tconst { name, importsDefault } = required[source];\n\t\t\t\t\treturn `import ${importsDefault ? `${name} from ` : ``}'${PROXY_PREFIX}${source}';`;\n\t\t\t\t})\n\t\t\t)\n\t\t\t.join('\\n') + '\\n\\n';\n\n\tconst namedExportDeclarations = [];\n\tlet wrapperStart = '';\n\tlet wrapperEnd = '';\n\n\tconst moduleName = deconflict(scope, globals, getName(id));\n\tif (!isEntry) {\n\t\tconst exportModuleExports = {\n\t\t\tstr: `export { ${moduleName} as __moduleExports };`,\n\t\t\tname: '__moduleExports'\n\t\t};\n\n\t\tnamedExportDeclarations.push(exportModuleExports);\n\t}\n\n\tconst name = getName(id);\n\n\tfunction addExport(x) {\n\t\tconst deconflicted = deconflict(scope, globals, name);\n\n\t\tconst declaration =\n\t\t\tdeconflicted === name\n\t\t\t\t? `export var ${x} = ${moduleName}.${x};`\n\t\t\t\t: `var ${deconflicted} = ${moduleName}.${x};\\nexport { ${deconflicted} as ${x} };`;\n\n\t\tnamedExportDeclarations.push({\n\t\t\tstr: declaration,\n\t\t\tname: x\n\t\t});\n\t}\n\n\tif (customNamedExports) customNamedExports.forEach(addExport);\n\n\tconst defaultExportPropertyAssignments = [];\n\tlet hasDefaultExport = false;\n\n\tif (shouldWrap) {\n\t\tconst args = `module${uses.exports ? ', exports' : ''}`;\n\n\t\twrapperStart = `var ${moduleName} = ${HELPERS_NAME}.createCommonjsModule(function (${args}) {\\n`;\n\t\twrapperEnd = `\\n});`;\n\t} else {\n\t\tconst names = [];\n\n\t\tast.body.forEach(node => {\n\t\t\tif (node.type === 'ExpressionStatement' && node.expression.type === 'AssignmentExpression') {\n\t\t\t\tconst left = node.expression.left;\n\t\t\t\tconst flattened = flatten(left);\n\n\t\t\t\tif (!flattened) return;\n\n\t\t\t\tconst match = exportsPattern.exec(flattened.keypath);\n\t\t\t\tif (!match) return;\n\n\t\t\t\tif (flattened.keypath === 'module.exports') {\n\t\t\t\t\thasDefaultExport = true;\n\t\t\t\t\tmagicString.overwrite(left.start, left.end, `var ${moduleName}`);\n\t\t\t\t} else {\n\t\t\t\t\tconst name = match[1];\n\t\t\t\t\tconst deconflicted = deconflict(scope, globals, name);\n\n\t\t\t\t\tnames.push({ name, deconflicted });\n\n\t\t\t\t\tmagicString.overwrite(node.start, left.end, `var ${deconflicted}`);\n\n\t\t\t\t\tconst declaration =\n\t\t\t\t\t\tname === deconflicted\n\t\t\t\t\t\t\t? `export { ${name} };`\n\t\t\t\t\t\t\t: `export { ${deconflicted} as ${name} };`;\n\n\t\t\t\t\tif (name !== 'default') {\n\t\t\t\t\t\tnamedExportDeclarations.push({\n\t\t\t\t\t\t\tstr: declaration,\n\t\t\t\t\t\t\tname\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdelete namedExports[name];\n\t\t\t\t\t}\n\n\t\t\t\t\tdefaultExportPropertyAssignments.push(`${moduleName}.${name} = ${deconflicted};`);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (!hasDefaultExport) {\n\t\t\twrapperEnd = `\\n\\nvar ${moduleName} = {\\n${names\n\t\t\t\t.map(({ name, deconflicted }) => `\\t${name}: ${deconflicted}`)\n\t\t\t\t.join(',\\n')}\\n};`;\n\t\t}\n\t}\n\tObject.keys(namedExports)\n\t\t.filter(key => !blacklist[key])\n\t\t.forEach(addExport);\n\n\tconst defaultExport = /__esModule/.test(code)\n\t\t? `export default ${HELPERS_NAME}.unwrapExports(${moduleName});`\n\t\t: `export default ${moduleName};`;\n\n\tconst named = namedExportDeclarations\n\t\t.filter(x => x.name !== 'default' || !hasDefaultExport)\n\t\t.map(x => x.str);\n\n\tconst exportBlock =\n\t\t'\\n\\n' +\n\t\t[defaultExport]\n\t\t\t.concat(named)\n\t\t\t.concat(hasDefaultExport ? defaultExportPropertyAssignments : [])\n\t\t\t.join('\\n');\n\n\tmagicString\n\t\t.trim()\n\t\t.prepend(importBlock + wrapperStart)\n\t\t.trim()\n\t\t.append(wrapperEnd + exportBlock);\n\n\tcode = magicString.toString();\n\tconst map = sourceMap ? magicString.generateMap() : null;\n\n\treturn { code, map };\n}\n","import { extname, resolve } from 'path';\nimport { sync as nodeResolveSync } from 'resolve';\nimport { createFilter } from 'rollup-pluginutils';\nimport { EXTERNAL_PREFIX, HELPERS, HELPERS_ID, PROXY_PREFIX } from './helpers.js';\nimport { getIsCjsPromise, setIsCjsPromise } from './is-cjs';\nimport { getResolveId } from './resolve-id';\nimport { checkEsModule, hasCjsKeywords, transformCommonjs } from './transform.js';\nimport { getName } from './utils.js';\n\nexport default function commonjs(options = {}) {\n\tconst extensions = options.extensions || ['.js'];\n\tconst filter = createFilter(options.include, options.exclude);\n\tconst ignoreGlobal = options.ignoreGlobal;\n\n\tconst customNamedExports = {};\n\tif (options.namedExports) {\n\t\tObject.keys(options.namedExports).forEach(id => {\n\t\t\tlet resolvedId;\n\n\t\t\ttry {\n\t\t\t\tresolvedId = nodeResolveSync(id, { basedir: process.cwd() });\n\t\t\t} catch (err) {\n\t\t\t\tresolvedId = resolve(id);\n\t\t\t}\n\n\t\t\tcustomNamedExports[resolvedId] = options.namedExports[id];\n\t\t});\n\t}\n\n\tconst esModulesWithoutDefaultExport = Object.create(null);\n\tconst esModulesWithDefaultExport = Object.create(null);\n\tconst allowDynamicRequire = !!options.ignore; // TODO maybe this should be configurable?\n\n\tconst ignoreRequire =\n\t\ttypeof options.ignore === 'function'\n\t\t\t? options.ignore\n\t\t\t: Array.isArray(options.ignore)\n\t\t\t\t? id => options.ignore.includes(id)\n\t\t\t\t: () => false;\n\n\tlet entryModuleIdsPromise = null;\n\n\tconst resolveId = getResolveId(extensions);\n\n\tconst sourceMap = options.sourceMap !== false;\n\n\treturn {\n\t\tname: 'commonjs',\n\n\t\toptions(options) {\n\t\t\tresolveId.setRollupOptions(options);\n\t\t\tconst input = options.input || options.entry;\n\t\t\tconst entryModules = Array.isArray(input)\n\t\t\t\t? input\n\t\t\t\t: typeof input === 'object' && input !== null\n\t\t\t\t\t? Object.values(input)\n\t\t\t\t\t: [input];\n\t\t\tentryModuleIdsPromise = Promise.all(entryModules.map(entry => resolveId(entry)));\n\t\t},\n\n\t\tresolveId,\n\n\t\tload(id) {\n\t\t\tif (id === HELPERS_ID) return HELPERS;\n\n\t\t\t// generate proxy modules\n\t\t\tif (id.startsWith(EXTERNAL_PREFIX)) {\n\t\t\t\tconst actualId = id.slice(EXTERNAL_PREFIX.length);\n\t\t\t\tconst name = getName(actualId);\n\n\t\t\t\treturn `import ${name} from ${JSON.stringify(actualId)}; export default ${name};`;\n\t\t\t}\n\n\t\t\tif (id.startsWith(PROXY_PREFIX)) {\n\t\t\t\tconst actualId = id.slice(PROXY_PREFIX.length);\n\t\t\t\tconst name = getName(actualId);\n\n\t\t\t\treturn getIsCjsPromise(actualId).then(isCjs => {\n\t\t\t\t\tif (isCjs)\n\t\t\t\t\t\treturn `import { __moduleExports } from ${JSON.stringify(\n\t\t\t\t\t\t\tactualId\n\t\t\t\t\t\t)}; export default __moduleExports;`;\n\t\t\t\t\telse if (esModulesWithoutDefaultExport[actualId])\n\t\t\t\t\t\treturn `import * as ${name} from ${JSON.stringify(actualId)}; export default ${name};`;\n\t\t\t\t\telse if (esModulesWithDefaultExport[actualId]) {\n\t\t\t\t\t\treturn `export {default} from ${JSON.stringify(actualId)};`;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn `import * as ${name} from ${JSON.stringify(\n\t\t\t\t\t\t\tactualId\n\t\t\t\t\t\t)}; import {getCjsExportFromNamespace} from \"${HELPERS_ID}\"; export default getCjsExportFromNamespace(${name})`;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\ttransform(code, id) {\n\t\t\tif (!filter(id) || extensions.indexOf(extname(id)) === -1) {\n\t\t\t\tsetIsCjsPromise(id, Promise.resolve(null));\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst transformPromise = entryModuleIdsPromise\n\t\t\t\t.then(entryModuleIds => {\n\t\t\t\t\tconst { isEsModule, hasDefaultExport, ast } = checkEsModule(this.parse, code, id);\n\t\t\t\t\tif (isEsModule) {\n\t\t\t\t\t\t(hasDefaultExport ? esModulesWithDefaultExport : esModulesWithoutDefaultExport)[id] = true;\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\t// it is not an ES module but it does not have CJS-specific elements.\n\t\t\t\t\tif (!hasCjsKeywords(code, ignoreGlobal)) {\n\t\t\t\t\t\tesModulesWithoutDefaultExport[id] = true;\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst transformed = transformCommonjs(\n\t\t\t\t\t\tthis.parse,\n\t\t\t\t\t\tcode,\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tentryModuleIds.indexOf(id) !== -1,\n\t\t\t\t\t\tignoreGlobal,\n\t\t\t\t\t\tignoreRequire,\n\t\t\t\t\t\tcustomNamedExports[id],\n\t\t\t\t\t\tsourceMap,\n\t\t\t\t\t\tallowDynamicRequire,\n\t\t\t\t\t\tast\n\t\t\t\t\t);\n\t\t\t\t\tif (!transformed) {\n\t\t\t\t\t\tesModulesWithoutDefaultExport[id] = true;\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn transformed;\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tthis.error(err, err.loc);\n\t\t\t\t});\n\n\t\t\tsetIsCjsPromise(id, transformPromise.then(Boolean, () => false));\n\t\t\treturn transformPromise;\n\t\t}\n\t};\n}\n"],"names":["const","let","resolve","fs.statSync","path","dirname","makeLegalIdentifier","basename","extname","sep","statSync","attachScopes","walk","flattened","required","createFilter","nodeResolveSync","options","actualId","name","this"],"mappings":"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"}